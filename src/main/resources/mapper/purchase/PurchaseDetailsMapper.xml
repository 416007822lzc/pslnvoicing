<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.pslnvoicing.mapper.purchase.PurchaseDetailsMapper">
    <resultMap id="purchaseOrderMap" type="com.example.pslnvoicing.pojos.PurchaseOrder">
        <id property="pOId" column="p_o_id" />
        <result property="supplierId" column="supplier_id" />
        <result property="warehouseId" column="warehouse_id" />
        <result property="empId" column="emp_id" />
        <result property="pOPurchasenumber" column="p_o_purchasenumber" />
        <result property="pODocumentdate" column="p_o_documentdate" />
        <result property="pODeliverydate" column="p_o_deliverydate" />
        <result property="pOJine" column="p_o_jine" />
        <result property="pOPurchasingstaff" column="p_o_purchasingstaff" />
        <result property="pOApprovalstatus" column="p_o_approvalstatus" />
        <result property="pOFinalapprovaltime" column="p_o_finalapprovaltime"/>
        <result property="pOExecutionstatus" column="p_o_executionstatus"/>
        <result property="pORepositorystatus" column="p_o_repositorystatus"/>
        <result property="pONotesondocuments" column="p_o_notesondocuments"/>
        <result property="pOCreationtime" column="p_o_creationtime"/>
        <result property="pOModificationtime" column="p_o_modificationtime"/>
        <result property="pWWarehousingnumber" column="p_w_warehousingnumber"/>

        <association property="empId" javaType="com.example.pslnvoicing.pojos.PersonnelEmp">
            <id property="empId" column="emp_id"/>
            <result property="empName" column="emp_name" />
            <result property="empGender" column="emp_gender" />
            <result property="empPhone" column="emp_phone" />
            <result property="empEmil" column="emp_emil" />
            <result property="empPassword" column="emp_password" />
            <result property="deptId" column="dept_id" />
        </association>

        <association property="supplierId" javaType="com.example.pslnvoicing.pojos.PslnvoicingSuppier" >
            <id property="supplierId" column="client_id" />
            <result property="supplierName" column="client_name"/>
        </association>

        <association property="warehouseId" javaType="com.example.pslnvoicing.pojos.PslnvoiningWarehouse">
            <id property="warehouseId"  column="warehouse_id" />
            <result property="warehouseName" column="warehouse_name"/>
        </association>
    </resultMap>


    <select id="findAllDeliveryOrder" resultMap="purchaseOrderMap">
        select *  from td_delivery_order  t
        LEFT JOIN personnel_emp p on t.emp_id=p.emp_id LEFT JOIN  pslnvoicing_client p1 on
        t.client_id=p1.client_id  LEFT JOIN pslnvoining_warehouse p2 on t.warehouse_id=p2.warehouse_id
        <where>
            <if test="startTime != null and startTime != '' and endTime != null and endTime != '' ">
                and  t.delivery_time >= #{startTime} and t.delivery_time &lt; #{endTime}
            </if>
            <if test="status != null">
                and t.approval_status = #{status}
            </if>
            <if test="empNameOrStoreNameOrNumber != null and empNameOrStoreNameOrNumber != ''">
                and (p2.warehouse_name like #{empNameOrStoreNameOrNumber}
                or p.emp_name like #{empNameOrStoreNameOrNumber}
                or t.delivery_order_number like #{empNameOrStoreNameOrNumber})
            </if>
        </where>
    </select>

</mapper>